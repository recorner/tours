{# Themed Navbar Items for DAVAG Safari with Hover Effects #}
{% macro render_item(item, submenu=False, parent=False) %}
    {% if item.child_items %}
        {% if parent %}
            {%- set dropdown_id = 'id-' + frappe.utils.generate_hash(length=12) -%}
            <li class="nav-item dropdown {% if submenu %} dropdown-submenu {% endif %}">
                <a class="nav-link dropdown-toggle fw-medium text-dark hover-effect" href="#" id="{{ dropdown_id }}"
                   role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    {{ _(item.label) }}
                </a>
                <ul class="dropdown-menu shadow-lg border-0 rounded-3 mt-2" aria-labelledby="{{ dropdown_id }}">
                    {% for child in item.child_items %}
                        {{ render_item(child, True) }}
                    {% endfor %}
                </ul>
            </li>
        {% else %}
            {%- set dropdown_id = 'id-' + frappe.utils.generate_hash(length=12) -%}
            <li class="dropdown {% if submenu %} dropdown-submenu {% endif %}">
                <a class="dropdown-item dropdown-toggle fw-medium text-dark hover-effect" href="#" id="{{ dropdown_id }}"
                   role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    {{ _(item.label) }}
                </a>
                <ul class="dropdown-menu shadow-lg border-0 rounded-3 mt-2" aria-labelledby="{{ dropdown_id }}">
                    {% for child in item.child_items %}
                        {{ render_item(child, True) }}
                    {% endfor %}
                </ul>
            </li>
        {% endif %}
    {% else %}
        {% set url = item.url or '' %}
        {% set url = url if url.startswith('#') else url | abs_url %}

        {% if parent %}
            <li class="nav-item px-3 px-xl-4">
                <a class="nav-link fw-medium text-dark hover-effect" href="{{ url }}"
                   {% if item.open_in_new_tab %} target="_blank" {% endif %}>
                    {{ _(item.label) }}
                </a>
            </li>
        {% else %}
            <a class="dropdown-item py-2 hover-effect" href="{{ url }}"
               {% if item.open_in_new_tab %} target="_blank" {% endif %}>
                {{ _(item.label) }}
            </a>
        {% endif %}
    {% endif %}
{% endmacro %}

{# Left-aligned nav items #}
{% if top_bar_items -%}
<ul class="navbar-nav me-auto">
    {%- for item in top_bar_items -%}
        {% if not item.parent_label and not item.right -%}
            {{ render_item(item, parent=True) }}
        {%- endif -%}
    {%- endfor %}
</ul>
{%- endif %}

{# Right-aligned nav items (now left-aligned in mobile as well) #}
<ul class="navbar-nav me-auto align-items-lg-center align-items-start">
    {% include "templates/includes/navbar/navbar_search.html" %}
    {%- for item in top_bar_items -%}
        {% if not item.parent_label and item.right -%}
            {{ render_item(item, parent=True) }}
        {%- endif -%}
    {%- endfor %}

    {% if not only_static %}
        {% block navbar_right_extension %}{% endblock %}
    {% endif %}

    {% if show_sidebar and sidebar_items %}
    <div class="d-block d-lg-none mt-3">
        <hr>
        {% for item in sidebar_items -%}
        <li class="nav-item">
            {% if item.type != 'input' %}
                <a href="{{ item.route }}" class="nav-link fw-medium hover-effect {{ 'text-dark' if pathname==item.route else 'text-muted'}}"
                   {% if item.target %}target="{{ item.target }}"{% endif %}>
                    {{ _(item.title or item.label) }}
                </a>
            {% endif %}
        </li>
        {%- endfor %}
        <hr>
    </div>
    {% endif %}

    {% if read_only_mode %}
        <div class="indicator-pill bg-warning text-dark rounded px-2 ms-2 small align-self-center"
             title="{{ _('This site is in read only mode, full functionality will be restored soon.') }}">
            {{ _('Read Only Mode') }}
        </div>
    {% endif %}

    {% include "templates/includes/navbar/davag_navbar_login.html" %}
</ul>

{%- if call_to_action -%}
<a class="btn btn-primary fw-medium ms-lg-3 mt-3 mt-lg-0 hover-effect" href="{{ call_to_action_url | abs_url }}">
    {{ call_to_action }}
</a>
{%- endif -%}

